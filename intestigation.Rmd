---
title: "IDS investigation worksheet"
author: "by Team-Name: User1, User2, User3, User4 & User5"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
library(readr)
library(dplyr)
library(janitor)

```





```{r load-data}
olympics <- read_csv("data/olympics.csv", show_col_types = FALSE)
```

``` {r}

olympics_medals <- olympics %>%
  drop_na()

#finding win percentage overall
olympics %>% 
  group_by(medal) %>% 
  summarise(count = n()) %>%
  mutate(win_pct = count/sum(count) * 100 )

# athletes by team
olympics %>%
  group_by(team) %>% 
  summarise(count = n()) %>%
  mutate(team_pct = count/sum(count) * 100 ) %>%
  arrange(desc(team_pct))

# medals by team
olympics_medals %>%
  group_by(team) %>% 
  summarise(count = n()) %>%
  mutate(medals_pct = count/sum(count) * 100 ) %>%
  arrange(desc(medals_pct))

# teams in sports
olympics_medals %>%
  count(team, sport) %>%
  arrange(desc(n))

```


``` {r, echo=FALSE}

# function to find upper and lower bounds for each season separately

bounds <- function(variable, s) { 
  # find lower and upper quartiles
  Q1 = as.numeric(quantile((olympics_medals%>%filter(season==s))[[variable]], 0.25))
  Q3 = as.numeric(quantile((olympics_medals%>%filter(season==s))[[variable]], 0.75))

  # find interquartile range
  IQR <-  Q3 - Q1

  # find lower and upper bounds to filter out outliers
  lower = Q1 - 1.5 * IQR
  upper = Q3 + 1.5 * IQR
  
  # return values
  return(list(lower=lower, upper=upper))
}

```


## Age Distribution

``` {r, echo=FALSE}
# find upper and lower bounds of age for each season separately
bsW = bounds("age", "Winter")
lowerW = bsW$lower
upperW = bsW$upper

bsS = bounds("age", "Summer")
lowerS = bsS$lower
upperS = bsS$upper

# create new dataset by dynamically filtering out entries that are below/above lower/upper bounds
filteredA <- olympics_medals %>%
  mutate(
    lower = ifelse(season == "Winter", lowerW, lowerS),
    upper = ifelse(season == "Winter", upperW, upperS)
  ) %>%
  filter(age >= lower & age <= upper)
```

``` {r}
# create plots using filtered dataset
filteredA %>%
  ggplot(mapping = aes(y = age, x = medal)) + 
  geom_boxplot() + 
  facet_wrap( ~ season)

filteredA %>%
  ggplot(mapping = aes(x = age, fill = season)) + 
  geom_density(alpha = 0.5) + 
  facet_wrap( ~ medal, 
              ncol = 1)

filteredA %>% 
  ggplot(mapping = aes(x = age, fill = medal)) + 
  geom_density(alpha = 0.5) 

# find mean and median age for each combination of season and medal
filteredA %>%
  group_by(season, medal) %>%
  summarise(avg = mean(age),
            med = median(age))

# find mean and median age for each season
filteredA %>%
  group_by(season) %>%
  summarise(avg = mean(age),
            med = median(age))

# find mean and median age for each season
filteredA %>%
  group_by(medal) %>%
  summarise(avg = mean(age),
            med = median(age))
```
* More outliers in Summer Olympics than in Winter
* Avergae age of medal winners slightly higher in Winter Olympics (26) than in Summer (25)
* Almost no outliers below lower bound
* Remove outliers using Q1/Q3 -/+ 1.5IQR (this mostly targets outliers above upper bound)
* Distributions of age are closer to normal for each medal and season with differences between mean and median age not greater than 1 year
* For each medal, the average age of winner is between 24.98 and 25.11 years old




## Height Distribution

``` {r, echo=FALSE}
# find upper and lower bounds of age for each season separately
bsW = bounds("height", "Winter")
lowerW = bsW$lower
upperW = bsW$upper

bsS = bounds("height", "Summer")
lowerS = bsS$lower
upperS = bsS$upper

# create new dataset by dynamically filtering out entries that are below/above lower/upper bounds
filteredH <- olympics_medals %>%
  mutate(
    lower = ifelse(season == "Winter", lowerW, lowerS),
    upper = ifelse(season == "Winter", upperW, upperS)
  ) %>%
  filter(height >= lower & height <= upper)
```

``` {r}
filteredH %>%
  ggplot(mapping = aes(y = height, x = medal)) + 
  geom_boxplot() + 
  facet_wrap( ~ season)

filteredH %>%
  ggplot(mapping = aes(x = height, fill = season)) + 
  geom_density(alpha = 0.5) + 
  facet_wrap( ~ medal, 
              ncol = 1)

filteredH %>% 
  ggplot(mapping = aes(x = height, fill = medal)) + 
  geom_density(alpha = 0.5) 

# find mean and median age for each combination of season and medal
filteredH %>%
  group_by(season, medal) %>%
  summarise(avg = mean(height),
            med = median(height))

# find mean and median height for each season
filteredH %>%
  group_by(season) %>%
  summarise(avg = mean(height),
            med = median(height))

# find mean and median age for each season
filteredH %>%
  group_by(medal) %>%
  summarise(avg = mean(height),
            med = median(height))

```
* Very few outliers in winter olympics, a lot in summer on both ends of the distribution
* Remove outliers using Q1/Q3 -/+ 1.5IQR
* Range of heights greater for Summer Olympics athletes than Winter
* Average height slightly larger for Summer Olympics (178.0) than Winter (175.6)
* For each medal, the height distributions are close to normal in both seasons, with differences between mean and median of at most 1.1 cm
* For each medal, the average height of winner is between 177.3 and 178.0 cm



## Weight Distribution

``` {r, echo=FALSE}
# find upper and lower bounds of age for each season separately
bsW = bounds("weight", "Winter")
lowerW = bsW$lower
upperW = bsW$upper

bsS = bounds("weight", "Summer")
lowerS = bsS$lower
upperS = bsS$upper

# create new dataset by dynamically filtering out entries that are below/above lower/upper bounds
filteredW <- olympics_medals %>%
  mutate(
    lower = ifelse(season == "Winter", lowerW, lowerS),
    upper = ifelse(season == "Winter", upperW, upperS)
  ) %>%
  filter(weight >= lower & weight <= upper)
```

``` {r}
filteredW %>%
  ggplot(mapping = aes(y = weight, x = medal)) + 
  geom_boxplot() + 
  facet_wrap( ~ season)

filteredW %>%
  ggplot(mapping = aes(x = weight, fill = season)) + 
  geom_density(alpha = 0.5) + 
  facet_wrap( ~ medal, 
              ncol = 1)

filteredW %>% 
  ggplot(mapping = aes(x = weight, fill = medal)) + 
  geom_density(alpha = 0.5) 

# find mean and median weight for each combination of season and medal
filteredW %>%
  group_by(season, medal) %>%
  summarise(avg = mean(weight),
            med = median(weight))

# find mean and median weight for each season
filteredW %>%
  group_by(season) %>%
  summarise(avg = mean(weight),
            med = median(weight))

# find mean and median weight for each season
filteredW %>%
  group_by(medal) %>%
  summarise(avg = mean(weight),
            med = median(weight))


```

* Many outliers above upper bound in Summer Olympics, some below lower bound, but almost no outliers in Winter Olympics
* Remove outliers using Q1/Q3 -/+ 1.5IQR
* Range of athletes' weights higher in Summer Olympics than in Winter
* Average weight slightly higher in Summer Olympics (73.1) than in Winter (72.7)
* For each medal, the weight distributions are close to normal in both seasons, with differences between mean and median of at most 1.03 kg
* For each medal, the average weight of winner is between 72.7 and 73.5 kg





