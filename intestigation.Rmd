---
title: "IDS investigation worksheet"
author: "by Team-Name: User1, User2, User3, User4 & User5"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
library(readr)
library(dplyr)
library(janitor)

```





```{r load-data}
olympics <- read_csv("data/olympics.csv", show_col_types = FALSE)
```

``` {r}

olympics_medals <- olympics %>%
  drop_na()

#finding win percentage overall
olympics %>% 
  group_by(medal) %>% 
  summarise(count = n()) %>%
  mutate(win_pct = count/sum(count) * 100 )

# athletes by team
olympics %>%
  group_by(team) %>% 
  summarise(count = n()) %>%
  mutate(team_pct = count/sum(count) * 100 ) %>%
  arrange(desc(team_pct))

# medals by team
olympics_medals %>%
  group_by(team) %>% 
  summarise(count = n()) %>%
  mutate(medals_pct = count/sum(count) * 100 ) %>%
  arrange(desc(medals_pct))

# teams in sports
olympics_medals %>%
  count(team, sport) %>%
  arrange(desc(n))

```




## Age Distribution

``` {r}

# find lower and upper quartiles
Q1 = quantile(olympics_medals$age, 0.25)
Q3 = quantile(olympics_medals$age, 0.75)

# find interquartile range
IQR <-  Q3 - Q1

#find lower and upper bounds to filter out outliers
lower = Q1 - 1.5 * IQR
upper = Q3 + 1.5 * IQR

olympics_medals %>% 
  filter(age >= lower & age <= upper) %>%
  ggplot(mapping = aes(y = age, x = medal)) + 
  geom_boxplot() + 
  facet_wrap( ~ season)

olympics_medals %>%
  filter(age >= lower & age <= upper) %>%
  ggplot(mapping = aes(x = age, fill = season)) + 
  geom_density(alpha = 0.5) + 
  facet_wrap( ~ medal, 
              ncol = 1)

olympics_medals %>%
  filter(age >= lower & age <= upper) %>%
  group_by(season, medal) %>%
  summarise(avg = mean(age),
            med = median(age))


olympics_medals %>%
  filter(age >= lower & age <= upper) %>%
  group_by(season) %>%
  summarise(avg = mean(age),
            med = median(age))
```
*  More outliers in summer olympics than in winter
*  Avergae age of medal winners slightly higher in Winter Olympics (26) than in Summer (25)
*  Almost no outliers below lower bound
*  Remove outliers using Q1/Q3 -/+ 1.5IQR (this mostly targets outliers above upper bound)
*  Distributions of age are closer to normal for each medal and season with differences between mean and median age not greater than 1 year




## Height Distribution

``` {r}
# find lower and upper quartiles
Q1 = quantile(olympics_medals$height, 0.25)
Q3 = quantile(olympics_medals$height, 0.75)

# find interquartile range
IQR <-  Q3 - Q1

#find lower and upper bounds to filter out outliers
lower = Q1 - 1.5 * IQR
upper = Q3 + 1.5 * IQR


olympics_medals %>% 
  filter(height >= lower & height <= upper) %>%
  ggplot(mapping = aes(y = height, x = medal)) + 
  geom_boxplot() + 
  facet_wrap( ~ season)

olympics_medals %>%
  filter(height >= lower & height <= upper) %>%
  ggplot(mapping = aes(x = height, fill = season)) + 
  geom_density(alpha = 0.5) + 
  facet_wrap( ~ medal, 
              ncol = 1)

olympics_medals %>%
  filter(height >= lower & height <= upper) %>%
  group_by(season, medal) %>%
  summarise(avg = mean(height),
            med = median(height))


olympics_medals %>%
  filter(height >= lower & height <= upper) %>%
  group_by(season) %>%
  summarise(avg = mean(height),
            med = median(height))


```
*  Very few outliers in winter olympics, a lot in summer on both ends of the distribution
*  Remove outliers using Q1/Q3 -/+ 1.5IQR
*  Range of heights greater for Summer Olympics athletes than Winter
*  Average height slightly larger for Summer Olympics (178.0) than Winter (175.6)
*  For each medal, the height distributions are close to normal in both seasons, with differences between mean and median of at most 1.1 cm





``` {r}

olympics_medals %>% 
  ggplot(mapping = aes(x=weight)) + 
  geom_boxplot() + 
  facet_wrap( ~ medal,
              scales = "free",
              ncol = 1)

```